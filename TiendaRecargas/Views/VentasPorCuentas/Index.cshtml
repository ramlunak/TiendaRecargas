@using System.Linq
@{
    ViewData["Title"] = "Index";
}

<table class="table">
    <thead>
        <tr>
            <th>
                Nombre
            </th>
            <th>
                Total recargas
            </th>
            <th>
                Monto
            </th>

        </tr>
    </thead>
    <tbody>
        @if (ViewBag.Vendedores != null)
            @foreach (var item in ViewBag.Vendedores)
            {
                var vendedor = (Cuenta)item;

                <tr>
                    <td style="width:50%">
                        <i class="fas fa-user-shield"></i> <b> @vendedor.Nombre</b>
                    </td>

                    <td style="width:20%">
                        <b> @vendedor.Recargas.Count</b>
                    </td>
                    <td>
                        <b> $@vendedor.Recargas.Sum(x => x.monto).ToString("F2") USD</b>
                    </td>
                </tr>
                @if (vendedor.Subvendedores.Any())
                {
                    <tr>
                        <td colspan="3" class="pl-4">

                            <table class="table table-striped">
                                <tbody>
                                    @foreach (var sub in vendedor.Subvendedores)
                                    {
                                        var subvendedor = (Cuenta)sub;

                                        <tr>
                                            <td style="width:50%">
                                                @subvendedor.Nombre
                                            </td>

                                            <td style="width:20%">
                                                @subvendedor.Recargas.Count
                                            </td>
                                            <td>
                                                $@subvendedor.Recargas.Sum(x => x.monto).ToString("F2") USD
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>

                        </td>
                    </tr>
                }
            }
    </tbody>
</table>
